\documentclass[12pt]{amsproc}

\newcommand{\Yam}{\mathrm{Yam}}
\newcommand{\fcop}{\mathrm{fcop}}
\newcommand{\cop}{\mathrm{cop}}
\newcommand{\Rob}{\mathrm{Rob}}
\newcommand{\range}{\mathrm{range}}
\newcommand{\ot}{\leftarrow}
\newcommand{\Tab}{\mathrm{Tab}}
\newcommand{\wt}{\mathrm{wt}}

\newtheorem{theorem}{Theorem}
\newtheorem{lemma}[theorem]{Lemma}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}

\title{Real Crystals}
\author{Amritanshu Prasad}

\begin{document}
\maketitle

\section{Fractional Crystal Operators}
\label{sec:frac-ops}
We define operators $e_i^t, f_i^t, \sigma_i:A_n^\dagger\to A_n^\dagger\cup \{0\}$, for $i=1,\dotsc,n-1$, and $t\geq 0$.
In order to define the operators for a given $i$ on a timed word $w$, we will freeze a certain subwords of $w$.
To begin with freeze every term of $w$ which does not involve the letters $i$ and $j=i+1$ of $A_n$.
The unfrozen part of $w$ is a subword of the form:
\begin{displaymath}
  j^{s_1}i^{r_1}j^{s_2}i^{r_2}\dotsb j^{s_l}i^{r_l},
\end{displaymath}
for some $l$ and some positive real numbers $s_i, r_i$, except for the possibility that $s_1$ and $r_l$ are zero.
From the above subword, freeze segments $j^{\min(s_k,r_k)}i^{\min(s_k,r_k)}$ for each $k$.
Since one of the terms $2^{s_k}$ and $1^{r_k}$ will be entirely frozen for each $k$, the unfrozen part of $w$ will now have strictly fewer terms than before.
Thus this process will eventually terminate, with the unfrozen part being:
\begin{displaymath}
  i^rj^s \text{ for some }r,s\geq 0.
\end{displaymath}
We call $s$ the $e_i$-range of $w$, denoted $\range(e_i,w)$ and $r$ the $f_i$-range of $w$, denoted $\range(f_i,w)$.
For each $t\leq s$, define $we_i^t$ to be the timed word obtained by transforming the unfrozen subword of $w$ as
\begin{displaymath}
  e_i^t: i^rj^s\mapsto i^{r+t}j^{s-t},
\end{displaymath}
and leaving the frozen part unchanged.
For $t>s$, define $we_i^t=0$.
Similarly, for $t\leq r$, define $wf_i^t$ to be the timed word obtained by transforming the unfrozen part of $w$ as
\begin{displaymath}
  f_i^t: i^rj^s\mapsto i^{r-t}j^{s+t},
\end{displaymath}
and leaving the frozen part unchanged.
Finally define $w\sigma_i$ to be the timed word obtained by transforming the unfrozien subword of $w$ by
\begin{displaymath}
  \sigma_i:i^rj^s\mapsto i^sj^r,
\end{displaymath}
and leaving the frozen part unchanged.

Let $x\in A_{n-1}^\dagger$, say $x=c_1^{t_1}\dotsb c_k^{t_k}$.
Then define
\begin{align*}
  we^x & = w e_{c_1}^{t_1}\dotsb e_{c_k}^{t_k}\\
  w f^x & = w f_{c_1}^{t_1}\dotsb f_{c_k}^{t_k}
\end{align*}
The operators $e^x$ and $f^x$, for $x\in A_{n-1}^\dagger$ are called \emph{fractional crystal operators}.
\begin{lemma}
  \label{lemma:crystal-knuth}
  Suppose $w$ and $w'$ are timed words that are in the same timed Knuth equivalence class, i.e., $w\equiv w'$.
  Then for any timed word $x\in A_{n-1}^\dagger$, if $we^x\neq 0$, then $w'e^x\neq 0$, and $we^x\equiv w'e^x$.
\end{lemma}
\begin{lemma}
  \label{lemma:tableau-crystal}
  If $w$ is [the reading word of] a timed tableau, then $we^x$ and $wf^x$, when not $0$, are also [reading words of] timed taleaux.
  In other words, fractional crystal operators act on timed tableaux.
\end{lemma}
\begin{definition}
  [Yamanouchi Timed Word]
  A timed word $w\in A_n^\dagger$ is said to have \emph{dominant valuation} if its weight vector is weakly decreasing.
  The timed word $w$ is said to be Yamanouchi if the every suffix has a dominant valuation.
  The set of all Yamanouchi timed words of weight $\lambda$ is denoted $\Yam^\dagger(\lambda)$.
\end{definition}
\begin{lemma}
  A timed word $w\in A_n^\dagger$ has the property that $\range(e_i,w)=0$ for $i=1,\dotsc,n-1$ if and only if $w$ is a timed Yamanouchi word.
\end{lemma}
\begin{lemma}
  For every $w\in A_n^\dagger$ there exists $x\in A_{n-1}^\dagger$ such that $we^x$ is a timed Yamanouchi word.
  Moreover, if $we^x$ and $we^{x'}$ are both Yamanouchi words, then they are equal.
\end{lemma}
\begin{proof}
  Both $P(w)e^x$ and $P(w)e^{x'}$ are timed tableaux of the same shape $\lambda$, by Lemma~\ref{lemma:tableau-crystal}.
  By Lemma~\ref{lemma:crystal-knuth}, $P(w)e^x\equiv we^x$ and $P(w)e^{x'}\equiv we^{x'}$.
  Since timed Knuth equivalence preserves Yamanouchiness, both $P(w)e^x$ and $P(w)e^{x'}$ are also Yamanouchi words.
  But the only timed tableaux of shape $\lambda$ that is also a Yamanouchi word is the superstandard tableau of shape $\lambda$.
  So $P(w)e^x=P(w)e^{x'}$.
  Therefore $we^x$ and $we^{x'}$ are Yamanouchi timed words of the same weight.???
\end{proof}
\section{Fractional Coplactic Classes}
\label{sec:fract-copl-class}
\begin{definition}[Fractional Coplactic Class]
  Say that two words $v$ and $w$ are in the same fractional coplactic class if there exists a timed word $x\in A_{n-1}^\dagger$ such that $v=we^x$ or $v=wf^x$.
\end{definition}
\begin{definition}[Real Crystal]
  A real crystal of a timed word $w$ is the coplactic class of $w$, together with families of relations $e_i^t$ and $f_i^t$, for $i=1,\dotsc,n-1$, and $t>0$ defined by $we_i^t w'$ if $we_i^t = w'$ and $wf_i^tw'$ if $wf_i^t=w'$.
\end{definition}
Each fractional coplactic class is a real crystal in the obvious manner.
An isomorphism of real crystals is a bijection which preserves all the relations $e_i^t$ and $f_i^t$.

\section{The Robinson Correspondence}
\label{sec:rob}
The following algorithm takes as input $w\in A_n^\dagger$, and returns a Yamanouchi timed word $Y(w)$ in the fractional coplactic class of $w$.
\begin{center}
  \textbf{Robinson's Algorithm}
\end{center}
\begin{itemize}
\item for $i$ in $1,\dotsc,n-1$:
  \begin{itemize}
  \item for $j$ in $i, i-1,\dotsc,1$:
    \begin{itemize}
    \item $w\ot w e_j^{\range(e_j,w)}$
    \end{itemize}
  \end{itemize}
  Return $w$
\end{itemize}
\begin{theorem}
  [Robinson's correspondence]
  The map:
  \begin{displaymath}
    R:w\mapsto (P(w),Y(w)) 
  \end{displaymath}
  defines a bijection
  \begin{displaymath}
    \Rob: A_n^\dagger \tilde\to \coprod_\lambda \Tab^\dagger_n(\lambda)\times \Yam^\dagger(\lambda).
  \end{displaymath}
\end{theorem}
\begin{proof}
  The inverse is obtained as follows:
  Given $(u,y)\in \Tab_n^\dagger(\lambda)\times \Yam^\dagger(\lambda)$, apply Robinson's algorithm to $u$ until the superstandard tableau $t_\lambda^0$ of shape $\lambda$ is obtained.
  This gives a word $x\in A_{n-1}^\dagger$ such that $ue^x=t_\lambda^0$.
  Let $x^*$ be the opposite word to $x$.
  Recover $w=yf^{x^*}$.
\end{proof}
\begin{definition}
  [Depth and rise]
  The $i$-depth of a timed word $w$ is defined as:
  \begin{displaymath}
    \delta_i(w)=\sup\{t\geq 0\mid we_i^t\neq 0\},
  \end{displaymath}
  Define the depth vector of $w$ to be:
  \begin{displaymath}
    \delta(w) = (\delta_1(w),\delta_2(w),\dotsc,\delta_{n-1}(w))
  \end{displaymath}
  and the $i$-rise of a timed word $w$ is defined as:
  \begin{displaymath}
    \epsilon_i(w) = \sup\{t\geq 0\mid wf_i^t\neq 0\}.
  \end{displaymath}
  Define the rise vector to $w$ to be:
  \begin{displaymath}
    \epsilon(w) = (\epsilon_1(w),\epsilon_2(w),\dotsc,\epsilon_{n-1}(w)).
  \end{displaymath}
\end{definition}
\begin{theorem}
  A word $w$ is Yamanouchi if and only if $\delta(w)=0$.
\end{theorem}
\begin{definition}
  [Difference operators]
  Recall Stembridge's difference operators:
  \begin{align*}
    \Delta_i\delta_j(w) & = \delta_j(we_i)-\delta_j(w) & \text{if } \delta_i(w)\geq 1,\\
    \nabla_i\delta_j(w) & = \delta_j(w)-\delta_j(wf_i) & \text{if } \epsilon_i(w)\geq 1.
  \end{align*}
  and define their infinitesimal versions for timed words:
  \begin{align*}
    \frac{\partial\delta_j^+}{\partial e_i} &= \lim_{t\to 0^+}\frac{\delta(we_i^t)-\delta(w)}t & \text{if } \delta_i(w)>0,\\
    \frac{\partial\delta_j^-}{\partial e_i} &= \lim_{t\to 0^-}\frac{\delta(we_i^t)-\delta(w)}t & \text{if } \epsilon_i(w)>0.
  \end{align*}
\end{definition}
\begin{theorem}
  If $y$ and $y'$ are Yamanouchi timed words of weight $\lambda$, then their fractional coplactic classes are isomorphic as real crystals.
\end{theorem}
Let $y^0_\lambda$ denote the unique timed tableau of shape $\lambda$ and weight $\lambda$.
Then $y^0_\lambda$ is also the only timed tableau of weight $\lambda$ that is also Yamanouchi.
\begin{theorem}
  The fractional coplactic class $\fcop(y^0_\lambda)$ consists of all timed tableaux of shape $\lambda$ in $A_n^\dagger$.
\end{theorem}
\begin{lemma}
  Let $w\in A_n^\dagger$, and $i\in 1,\dotsc, n-1$.
  Then
  \begin{displaymath}
    P(w e_i^t) = P(w) e_i^t.
  \end{displaymath}
\end{lemma}

\section{Littlewood-Richardson using crystals}
We now recall the proof of the Littlewood-Richardson rule using crystal operators:
\label{sec:recoll-proof-littl}
For any word $w\in A_n^*$, let $C(w)$ denote the coplactic class of $w$.
Then the Schur function is defined by:
\begin{displaymath}
  s_\lambda(x_1,\dotsc,x_n) = \sum_{w\in C(y_\lambda)} \wt(w),
\end{displaymath}
where $y_\lambda$ is \emph{any} Yamanouchi word of wwight $\lambda$.
We have:
\begin{displaymath}
  s_\mu(x_1,\dotsc,x_n)s_\nu(x_1,\dotsc,x_n)=\sum_{u\in C(y^0_\mu),v\in C(y^0_\nu)} \wt(uv).
\end{displaymath}
For every $i$, the effect $(uv)e_i$ of the (classical) crystal operator is either $(ue_i)v$ or $u(ve_i)$, so the sum on the right hand side is a union of coplactic classes.
The number of coplactic classes containing a Yamanouchi word of weight $\lambda$ is equal to the number of Yamanouchi words of weight $\lambda$ in
\begin{displaymath}
  \{uv\mid u\in C(y^0_\mu),v\in C(y^0_\nu)\},
\end{displaymath}
Also, if $uv$ is Yamanouchi, then $v$ has to be Yamanouchi, hence $v=y_\nu^0$.
We get the crystal version of the Littlewood-Richardson rule:
\begin{displaymath}
  c^\lambda_{\mu\nu} = \#\{u\in C(y^0_\mu)\mid uy^0_\nu\in \Yam(\lambda)\}
\end{displaymath}
The saturation theorem says:
\begin{theorem}
  Given partition $\lambda$, $\mu$, and $\nu$, and a positive integer $N$, if $c^{N\lambda}_{N\mu N\nu}>0$, then $c^\lambda_{\mu\nu}>0$.
\end{theorem}
The hypothesis posits the existence of $u\in C(y_{N\mu}^0)$ such that $uy_{N\nu}^0\in \Yam(N\lambda)$.
Consider the timed word $\bar u=u^{1/N}\in A_n^\dagger$.
This world lies in $\fcop(y_\mu^0)$, and $uy_\nu^0$ is a Yamanouchi timed word of weight $\lambda$.
We would like to replace $\bar u$ with $\tilde u\in A_n*$ such that:
\begin{enumerate}
\item $\tilde u y^0_\nu\in \Yam_n(\lambda)$,
\item $\tilde u\in \cop(y_\mu^0)$.
\end{enumerate}

We have:
\begin{displaymath}
  \bar u e^x=y_\mu^0,
\end{displaymath}
where $x\in A_n^\dagger$.
We have $\lambda-\nu=\wt(\tilde u) = \mu-\sum_{i=1}^{n-1}\wt_i(x)(e_i-e_{i+1})$.
It follows that $\wt_i(x)$ is a nonnegative integer for every $i$.
Moreover, we can assume that
\begin{displaymath}
  x = 1^{t_{11}}\;2^{t_{22}}1^{t_{21}}\dotsb (n-1)^{t_{n-1,n-1}}\dotsb 1^{t_{n-1,1}}.
\end{displaymath}
It suffices to describe a rounding algorithm $x\mapsto r(x)\in A_n^*$ such $r(x)$ has the same weight as $x$, and the word $\tilde u$ determined by
\begin{displaymath}
  \tilde u e^{r(x)}=y_\mu^0
\end{displaymath}
has $\range(e_j,\tilde u)\leq \range(e_j,\bar u)$ for $j=1,\dotsc,n-1$.
\begin{lemma}
  For any $u\in A_n^\dagger$, $uy^0_\nu$ is Yamanouchi if and only if
  \begin{displaymath}
    \range(e_i,u)\leq \langle\nu,\alpha_i\rangle
  \end{displaymath}
  for $i=1,\dotsc,n-1$.
\end{lemma}
\section{Stembridge axioms}
\label{sec:stembridge-axioms}
\begin{theorem}
  For any $w\in A_n^\dagger$, the following hold whenever the result of plactic operations that appear in them do not result in $0$.
  \begin{enumerate}
  \item $\range(e_i,w)+\range(f_i,w)=\langle\wt(w),\alpha_i\rangle$.
  \item  We have:
    \begin{enumerate}
    \item $\range(e_i,we_i^t)=\range(e_i,w)-t$,
    \item $\range(e_i,w)\leq \range(e_i,we_{i+1}^t)\leq \range(e_i,w)+t$,
    \item $\range(e_{i+1},w)\leq \range(e_{i+1},we_i^t)\leq \range(e_{i+1},w)+t$,
    \item if $|i-j|>1$, then $\range(e_i,we_j)=\range(e_i,w)$.
    \end{enumerate}
  \item Also,
    \begin{enumerate}
    \item $\range(e_i,wf_i^t)=\range(e_i,w)+t$,
    \item $\range(e_i,w)\geq \range(e_i,wf_{i+1}^t)\geq \range(e_i,w)-t$,
    \item $\range(e_{i+1},w)\geq \range(e_{i+1},wf_i^t)\geq \range(e_{i+1},w)-t$,
    \item if $|i-j|>1$, then $\range(e_i,wf_j)=\range(e_i,w)$.
    \end{enumerate}
  \end{enumerate}
\end{theorem}
\end{document}
